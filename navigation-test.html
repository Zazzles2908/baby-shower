<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mom vs Dad - Navigation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        h1 { color: #333; }
        button { 
            padding: 15px 30px; 
            font-size: 16px; 
            margin: 10px; 
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover { background-color: #0056b3; }
        .result { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ® Mom vs Dad - Navigation Test</h1>
    
    <div>
        <button onclick="simulateNavigateToMomVsDad()">ğŸ§ª Test Navigation to Mom vs Dad</button>
        <button onclick="runFullTest()">ğŸš€ Run Full Initialization Test</button>
        <button onclick="checkCurrentState()">ğŸ” Check Current State</button>
    </div>

    <div id="results"></div>

    <!-- Include required scripts -->
    <script src="scripts/config.js"></script>
    <script src="scripts/api.js"></script>
    <script src="scripts/mom-vs-dad-simplified.js"></script>

    <script>
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
        }

        function simulateNavigateToMomVsDad() {
            addResult('=== Testing Navigation to Mom vs Dad ===', 'info');
            
            // Step 1: Check current state
            const section = document.getElementById('mom-vs-dad-section');
            const container = document.getElementById('mom-vs-dad-game');
            
            addResult(`1. Current section visibility: ${section ? section.className : 'section not found'}`);
            addResult(`2. Container exists: ${!!container}`);
            
            if (!section || !container) {
                addResult('âŒ ERROR: Required elements missing from DOM', 'error');
                return;
            }
            
            // Step 2: Show the section (simulate clicking the activity card)
            addResult('3. Showing mom-vs-dad section...', 'info');
            section.classList.remove('hidden');
            addResult(`   Section visibility after: ${section.className}`);
            
            // Step 3: Call reinitializeForSection
            addResult('4. Calling reinitializeForSection()...', 'info');
            if (window.MomVsDadSimplified && typeof window.MomVsDadSimplified.reinitializeForSection === 'function') {
                try {
                    window.MomVsDadSimplified.reinitializeForSection();
                    addResult('âœ… reinitializeForSection() completed successfully');
                    
                    // Step 4: Check if content was rendered
                    setTimeout(() => {
                        const hasContent = container.querySelector('.mvd-section');
                        addResult(`5. Content rendered: ${hasContent ? 'âœ… Yes' : 'âŒ No'}`);
                        
                        if (hasContent) {
                            const lobbyCards = container.querySelectorAll('.lobby-card');
                            addResult(`6. Lobby cards found: ${lobbyCards.length}`);
                            
                            if (lobbyCards.length > 0) {
                                addResult('âœ… SUCCESS: Game is rendered and ready!', 'success');
                            } else {
                                addResult('âš ï¸ WARNING: Section rendered but no lobby cards found', 'error');
                            }
                        } else {
                            addResult('âŒ FAILURE: No content rendered in container', 'error');
                            
                            // Check container content
                            addResult(`Container innerHTML: "${container.innerHTML.substring(0, 100)}..."`);
                        }
                    }, 500); // Wait for async operations
                    
                } catch (error) {
                    addResult(`âŒ ERROR in reinitializeForSection(): ${error.message}`, 'error');
                }
            } else {
                addResult('âŒ ERROR: MomVsDadSimplified.reinitializeForSection not available', 'error');
            }
        }

        function runFullTest() {
            addResult('=== Running Full Initialization Test ===', 'info');
            
            // Test 1: Script loading
            addResult(`1. Script loaded: ${typeof window.MomVsDadSimplified !== 'undefined' ? 'âœ… Yes' : 'âŒ No'}`, 
                      typeof window.MomVsDadSimplified !== 'undefined' ? 'success' : 'error');
            
            if (typeof window.MomVsDadSimplified !== 'undefined') {
                // Test 2: API availability
                addResult(`2. API available: ${typeof window.API !== 'undefined' ? 'âœ… Yes' : 'âš ï¸ No (may affect functionality)'}`, 
                          typeof window.API !== 'undefined' ? 'success' : 'info');
                
                // Test 3: Container availability
                const container = document.getElementById('mom-vs-dad-game');
                addResult(`3. Container available: ${container ? 'âœ… Yes' : 'âŒ No'}`, 
                          container ? 'success' : 'error');
                
                if (container) {
                    // Test 4: Direct initialization
                    addResult('4. Calling init() directly...', 'info');
                    try {
                        container.innerHTML = ''; // Clear container
                        window.MomVsDadSimplified.init();
                        
                        setTimeout(() => {
                            const hasContent = container.querySelector('.mvd-section');
                            addResult(`5. Direct init result: ${hasContent ? 'âœ… Content rendered' : 'âŒ No content'}`, 
                                      hasContent ? 'success' : 'error');
                            
                            if (hasContent) {
                                const lobbyCards = container.querySelectorAll('.lobby-card');
                                addResult(`6. Lobby cards: ${lobbyCards.length}`, 
                                          lobbyCards.length > 0 ? 'success' : 'error');
                            }
                        }, 500);
                        
                    } catch (error) {
                        addResult(`âŒ Init error: ${error.message}`, 'error');
                    }
                }
            }
        }

        function checkCurrentState() {
            addResult('=== Current State Check ===', 'info');
            
            const section = document.getElementById('mom-vs-dad-section');
            const container = document.getElementById('mom-vs-dad-game');
            
            addResult(`Section: ${section ? `Found (${section.className})` : 'Not found'}`);
            addResult(`Container: ${container ? 'Found' : 'Not found'}`);
            
            if (container) {
                const content = container.innerHTML.trim();
                addResult(`Container has content: ${content.length > 0 ? 'Yes' : 'No'}`);
                if (content.length > 0) {
                    addResult(`Content preview: ${content.substring(0, 200)}...`);
                }
            }
            
            addResult(`Script available: ${typeof window.MomVsDadSimplified !== 'undefined' ? 'Yes' : 'No'}`);
        }
    </script>
</body>
</html>