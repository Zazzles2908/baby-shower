{
  "timestamp": "2026-01-03T10:46:45.509Z",
  "baseUrl": "https://bkszmvfsfgvdwzacgmfz.supabase.co/functions/v1/",
  "sessionCode": "22AC6G",
  "adminPin": "4319",
  "tests": [
    {
      "name": "Create new game session",
      "passed": true,
      "timestamp": "2026-01-03T10:46:48.158Z",
      "details": {
        "session_id": "5083a942-5eeb-4a7a-917e-1f930217146a",
        "session_code": "22AC6G",
        "admin_code": "4319",
        "mom_name": "Test Mom",
        "dad_name": "Test Dad",
        "status": "setup",
        "current_round": 0,
        "total_rounds": 3,
        "created_at": "2026-01-03T10:46:47.952Z"
      },
      "error": null
    },
    {
      "name": "Get existing session by code",
      "passed": true,
      "timestamp": "2026-01-03T10:46:50.435Z",
      "details": {
        "session_code": "XCWFHJ",
        "mom_name": "Emma",
        "dad_name": "Oliver",
        "status": "voting",
        "current_round": 0,
        "total_rounds": 3,
        "created_at": "2026-01-03T10:04:14.834Z"
      },
      "error": null
    },
    {
      "name": "Join session as guest",
      "passed": true,
      "timestamp": "2026-01-03T10:46:52.732Z",
      "details": {
        "session_code": "22AC6G",
        "mom_name": "Test Mom",
        "dad_name": "Test Dad",
        "status": "setup",
        "current_round": 0,
        "total_rounds": 3
      },
      "error": null
    },
    {
      "name": "Update session status to voting",
      "passed": true,
      "timestamp": "2026-01-03T10:46:55.251Z",
      "details": {
        "session_code": "22AC6G",
        "status": "voting",
        "current_round": 0,
        "total_rounds": 3
      },
      "error": null
    },
    {
      "name": "Reject missing mom name",
      "passed": true,
      "timestamp": "2026-01-03T10:46:57.339Z",
      "details": [
        "Mom name is required"
      ],
      "error": null
    },
    {
      "name": "Reject invalid session code",
      "passed": true,
      "timestamp": "2026-01-03T10:46:59.449Z",
      "details": [
        "Session code must be 6 characters"
      ],
      "error": null
    },
    {
      "name": "Generate new scenario",
      "passed": true,
      "timestamp": "2026-01-03T10:47:04.434Z",
      "details": {
        "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
        "scenario_text": "It's 3 AM and the baby has a dirty diaper that requires immediate attention.",
        "mom_option": "Test Mom would handle it with grace",
        "dad_option": "Test Dad would figure it out",
        "intensity": "0.50"
      },
      "error": null
    },
    {
      "name": "Get current scenario",
      "passed": true,
      "timestamp": "2026-01-03T10:47:07.081Z",
      "details": {
        "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
        "scenario_text": "It's 3 AM and the baby has a dirty diaper that requires immediate attention.",
        "mom_option": "Test Mom would handle it with grace",
        "dad_option": "Test Dad would figure it out",
        "intensity": "0.50",
        "created_at": "2026-01-03T10:47:04.229Z"
      },
      "error": null
    },
    {
      "name": "Reject missing session_id",
      "passed": true,
      "timestamp": "2026-01-03T10:47:09.260Z",
      "details": [
        "session_id is required"
      ],
      "error": null
    },
    {
      "name": "Reject invalid theme",
      "passed": true,
      "timestamp": "2026-01-03T10:47:11.380Z",
      "details": [
        "theme must be one of: general, farm, funny, sleep, feeding, messy, emotional"
      ],
      "error": null
    },
    {
      "name": "Submit vote for mom",
      "passed": true,
      "timestamp": "2026-01-03T10:47:14.997Z",
      "details": {
        "vote_counts": {
          "mom_votes": 1,
          "dad_votes": 0,
          "mom_pct": 100,
          "dad_pct": 0,
          "total_votes": 1
        },
        "your_vote": {
          "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
          "guest_name": "Guest 1",
          "choice": "mom"
        }
      },
      "error": null
    },
    {
      "name": "Submit vote for dad",
      "passed": true,
      "timestamp": "2026-01-03T10:47:18.107Z",
      "details": {
        "vote_counts": {
          "mom_votes": 1,
          "dad_votes": 1,
          "mom_pct": 50,
          "dad_pct": 50,
          "total_votes": 2
        },
        "your_vote": {
          "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
          "guest_name": "Guest 2",
          "choice": "dad"
        }
      },
      "error": null
    },
    {
      "name": "Submit additional vote for mom",
      "passed": true,
      "timestamp": "2026-01-03T10:47:21.224Z",
      "details": {
        "vote_counts": {
          "mom_votes": 2,
          "dad_votes": 1,
          "mom_pct": 67,
          "dad_pct": 33,
          "total_votes": 3
        },
        "your_vote": {
          "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
          "guest_name": "Guest 3",
          "choice": "mom"
        }
      },
      "error": null
    },
    {
      "name": "Get vote counts",
      "passed": true,
      "timestamp": "2026-01-03T10:47:23.739Z",
      "details": {
        "mom_votes": 2,
        "dad_votes": 1,
        "mom_pct": 67,
        "dad_pct": 33,
        "total_votes": 3
      },
      "error": null
    },
    {
      "name": "Update existing vote",
      "passed": true,
      "timestamp": "2026-01-03T10:47:26.813Z",
      "details": {
        "vote_counts": {
          "mom_votes": 1,
          "dad_votes": 2,
          "mom_pct": 33,
          "dad_pct": 67,
          "total_votes": 3
        },
        "your_vote": {
          "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
          "guest_name": "Guest 1",
          "choice": "dad"
        }
      },
      "error": null
    },
    {
      "name": "Reject invalid vote choice",
      "passed": true,
      "timestamp": "2026-01-03T10:47:28.896Z",
      "details": [
        "vote_choice must be \"mom\" or \"dad\""
      ],
      "error": null
    },
    {
      "name": "Reject missing scenario_id",
      "passed": true,
      "timestamp": "2026-01-03T10:47:31.007Z",
      "details": "Provide either vote data (scenario_id, guest_name, vote_choice) or lock data (scenario_id, parent, answer, admin_code)",
      "error": null
    },
    {
      "name": "Lock mom's answer",
      "passed": true,
      "timestamp": "2026-01-03T10:47:34.343Z",
      "details": {
        "locked": true,
        "both_locked": false,
        "mom_locked": true,
        "dad_locked": false,
        "mom_answer": "mom",
        "dad_answer": null
      },
      "error": null
    },
    {
      "name": "Lock dad's answer",
      "passed": true,
      "timestamp": "2026-01-03T10:47:37.173Z",
      "details": {
        "locked": true,
        "both_locked": true,
        "mom_locked": true,
        "dad_locked": true,
        "mom_answer": "mom",
        "dad_answer": "dad"
      },
      "error": null
    },
    {
      "name": "Reject invalid admin PIN",
      "passed": true,
      "timestamp": "2026-01-03T10:47:39.668Z",
      "details": "Invalid admin PIN",
      "error": null
    },
    {
      "name": "Reject invalid parent",
      "passed": true,
      "timestamp": "2026-01-03T10:47:41.835Z",
      "details": [
        "parent must be \"mom\" or \"dad\""
      ],
      "error": null
    },
    {
      "name": "Get reveal status",
      "passed": true,
      "timestamp": "2026-01-03T10:47:45.343Z",
      "details": {
        "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
        "is_revealed": false,
        "both_parents_locked": true,
        "session_status": "voting",
        "scenario": {
          "text": "It's 3 AM and the baby has a dirty diaper that requires immediate attention.",
          "mom_option": "Test Mom would handle it with grace",
          "dad_option": "Test Dad would figure it out"
        },
        "parents": {
          "mom_name": "Test Mom",
          "dad_name": "Test Dad"
        },
        "result": null
      },
      "error": null
    },
    {
      "name": "Trigger reveal",
      "passed": true,
      "timestamp": "2026-01-03T10:47:49.999Z",
      "details": {
        "roast_commentary": "ðŸ¤” Hmm, 67% picked wrong! Test Mom had other plans!",
        "perception_gap": 34,
        "vote_comparison": {
          "mom_votes": 1,
          "dad_votes": 2,
          "mom_percentage": 33,
          "dad_percentage": 67,
          "total_votes": 3,
          "crowd_choice": "dad",
          "actual_choice": "mom"
        },
        "particle_effect": "confetti",
        "result_id": "b6f69bc2-e6e4-4818-943f-9747107168cd",
        "scenario_info": {
          "text": "It's 3 AM and the baby has a dirty diaper that requires immediate attention.",
          "mom_option": "Test Mom would handle it with grace",
          "dad_option": "Test Dad would figure it out"
        },
        "round_info": {
          "current_round": 1,
          "total_rounds": 3
        }
      },
      "error": null
    },
    {
      "name": "Reject double reveal",
      "passed": true,
      "timestamp": "2026-01-03T10:47:52.564Z",
      "details": "Cannot trigger reveal - voting is not active",
      "error": null
    },
    {
      "name": "Reject missing scenario_id",
      "passed": true,
      "timestamp": "2026-01-03T10:47:54.687Z",
      "details": [
        "scenario_id is required"
      ],
      "error": null
    },
    {
      "name": "Reject invalid admin PIN for reveal",
      "passed": true,
      "timestamp": "2026-01-03T10:47:57.191Z",
      "details": "Invalid admin PIN",
      "error": null
    },
    {
      "name": "Handle invalid JSON",
      "passed": true,
      "timestamp": "2026-01-03T10:47:59.826Z",
      "details": 500,
      "error": null
    },
    {
      "name": "Reject GET on POST-only endpoint",
      "passed": false,
      "timestamp": "2026-01-03T10:48:01.940Z",
      "details": 400,
      "error": null
    },
    {
      "name": "Handle missing content type",
      "passed": true,
      "timestamp": "2026-01-03T10:48:04.031Z",
      "details": 400,
      "error": null
    },
    {
      "name": "Timeout handling works",
      "passed": true,
      "timestamp": "2026-01-03T10:48:05.035Z",
      "details": null,
      "error": null
    }
  ],
  "summary": {
    "total": 30,
    "passed": 29,
    "failed": 1,
    "skipped": 0
  },
  "sessionData": {
    "sessionId": "5083a942-5eeb-4a7a-917e-1f930217146a",
    "momName": "Test Mom",
    "dadName": "Test Dad",
    "scenarios": [
      {
        "scenario_id": "78e5c475-3bb6-4d64-a8e2-4a6dc6ae26bb",
        "scenario_text": "It's 3 AM and the baby has a dirty diaper that requires immediate attention.",
        "mom_option": "Test Mom would handle it with grace",
        "dad_option": "Test Dad would figure it out",
        "intensity": "0.50"
      }
    ]
  }
}